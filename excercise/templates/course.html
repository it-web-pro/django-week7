{% load custom_filter %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Course Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>

  <body class="bg-white text-gray-800">
    {% include 'nav.html' %}

    <main class="p-6 max-w-8xl mx-auto">
      <section class="mb-6 flex sm:flex-row flex-col gap-4 justify-between">
        <div class="flex items-center justify-between">
          <div>
            <h1 class="text-3xl font-bold text-orange-500">Course Dashboard</h1>
            <p class="text-gray-500">
              Total <span class="font-medium text-blue-500">{{total}}</span> Courses
            </p>
          </div>
        </div>
        <section aria-label="Filter content" class="sm:self-end sm:place-items-end flex flex-col gap-y-2">
          <label class="text-2xl font-medium" for="search">Quick Search</label>
          <input 
          class="block w-[300px] rounded-md field-sizing-content border-[1px] px-4 py-2" 
          id="search" 
          type="text" 
          placeholder="Search courses..." 
          autocomplete="search" value="{{search}}" 
          title="Filter data" />
        </section>
      </section>

      <div class="overflow-x-auto bg-white rounded-lg shadow border border-orange-100">
        <table class="min-w-full divide-y divide-orange-100">
          <thead class="bg-orange-100 text-left text-sm font-semibold text-gray-700">
            <tr>
              <th class="px-4 py-3">Course code</th>
              <th class="px-4 py-3">Name</th>
              <th class="px-4 py-3">Credits</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-100 text-sm">
            {% for course in course_list %}
              <tr class="hover:bg-orange-50 transition">
                <td class="px-4 py-3">{{ }}</td>
                <td class="px-4 py-3 font-medium">{{ }}</td>
                <td class="px-4 py-3">{{ }}</td>
              </tr>
            {% empty %}
              <tr>
                <td colspan="4" class="text-center text-gray-400 px-4 py-6">No course found.</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </main>

    <script>
      let typingTimer
      const doneTypingInterval = 500
      
      const searchInput = document.getElementById('search')
      if (searchInput.value !== '') {
        const endPosition = searchInput.value.length
        searchInput.setSelectionRange(endPosition, endPosition)
      }
      
      searchInput.addEventListener('keyup', () => {
        clearTimeout(typingTimer)
        typingTimer = setTimeout(doneTyping, doneTypingInterval)
      })
      
      function doneTyping() {
        // Hint: ใช้ template tag 'url' แทน '/'
        window.location.href = `/?search=${searchInput.value}`
      }
      if (searchInput.value) searchInput.focus()
    </script>
  </body>
</html>
